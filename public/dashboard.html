<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>CRM Pietra Fina - Dashboard</title>

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap"
            rel="stylesheet"
        />

        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            playfair: ['"Playfair Display"', "serif"],
                            inter: ['"Inter"', "sans-serif"],
                        },
                         colors: {
                            'brand-red': '#DC2626',
                            'brand-dark': '#111827',
                            'brand-light': '#F9FAFB',
                        }
                    },
                },
            };
        </script>

        <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
        <!-- Librería para Gráficas -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link rel="stylesheet" href="./style.css" />
    </head>
    <body class="bg-brand-light font-inter">
        <div class="flex h-screen bg-gray-100">
            <!-- Sidebar -->
            <aside
                id="sidebar"
                class="fixed inset-y-0 left-0 z-[100] flex h-full w-64 -translate-x-full flex-col border-r border-gray-200 bg-white transition-transform duration-300 md:relative md:translate-x-0"
            >
                <div class="flex items-center gap-3 p-4">
                    <img
                        src="https://pietrafina.com.mx/wp-content/uploads/2023/11/LOGO-PIETRA-FINA-NEGRO.svg"
                        alt="Logo Pietra Fina"
                        class="h-10"
                    />
                </div>
                <nav class="flex-1 p-4">
                    <ul class="space-y-2">
                        <li>
                            <a
                                href="./dashboard.html"
                                class="flex items-center gap-3 rounded-lg bg-gray-100 px-3 py-2 text-gray-900"
                            >
                                <i data-lucide="layout-dashboard"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a
                                href="./admin-app.html"
                                class="flex items-center gap-3 rounded-lg px-3 py-2 text-gray-600 hover:bg-gray-50"
                            >
                                <i data-lucide="users"></i>
                                <span>Gestión</span>
                            </a>
                        </li>
                        <li>
                            <a
                                href="./prospeccion.html"
                                class="flex items-center gap-3 rounded-lg px-3 py-2 text-gray-600 hover:bg-gray-50"
                            >
                                <i data-lucide="target"></i>
                                <span>Prospección</span>
                            </a>
                        </li>
                    </ul>
                </nav>
                <div class="mt-auto border-t p-4">
                    <div class="flex items-center gap-3">
                        <div
                            class="flex h-10 w-10 items-center justify-center rounded-full bg-gray-200 font-bold text-gray-700"
                            id="user-initials"
                        ></div>
                        <div>
                            <p class="font-semibold" id="user-name-display">
                                Cargando...
                            </p>
                            <p class="text-xs text-gray-500" id="user-role-display"></p>
                        </div>
                        <button
                            id="logout-btn"
                            class="ml-auto rounded-md p-2 text-gray-500 hover:bg-gray-100"
                            aria-label="Cerrar sesión"
                        >
                            <i data-lucide="log-out" class="h-5 w-5"></i>
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Contenido Principal -->
            <div class="flex flex-1 flex-col">
                <header
                    class="sticky top-0 z-50 flex h-16 items-center justify-between border-b bg-white px-4 md:justify-end"
                >
                    <button
                        id="menu-toggle-btn"
                        class="rounded-md p-2 text-gray-600 hover:bg-gray-100 md:hidden"
                        aria-label="Abrir menú"
                    >
                        <i data-lucide="menu" class="h-6 w-6"></i>
                    </button>
                    <h1 class="font-playfair text-xl font-bold md:hidden">
                        Dashboard
                    </h1>
                    <div></div>
                </header>

                <main class="flex-1 overflow-y-auto p-4 md:p-8">
                    <div class="mx-auto max-w-7xl">
                        <!-- Header del Dashboard -->
                        <div class="mb-8">
                            <h1
                                class="font-playfair text-3xl font-bold text-brand-dark"
                            >
                                Dashboard General
                            </h1>
                            <p class="text-gray-500">
                                Un resumen del rendimiento de tu prospección.
                            </p>
                        </div>

                        <!-- Tarjetas de Estadísticas (KPIs) -->
                        <div
                            id="stats-cards-container"
                            class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"
                        >
                           <!-- Las tarjetas se insertarán aquí dinámicamente -->
                           <div class="stat-card-placeholder"></div>
                           <div class="stat-card-placeholder"></div>
                           <div class="stat-card-placeholder"></div>
                           <div class="stat-card-placeholder"></div>
                        </div>

                        <!-- Gráficas -->
                        <div class="mt-8 grid grid-cols-1 gap-8 lg:grid-cols-5">
                           <!-- Gráfica de Estatus -->
                            <div class="dashboard-widget lg:col-span-2">
                                <h2 class="widget-title">Prospectos por Estatus</h2>
                                <div id="prospects-by-status-chart-container" class="mt-4">
                                     <canvas id="prospectsByStatusChart"></canvas>
                                </div>
                            </div>
                           <!-- Gráfica de Nuevos Prospectos -->
                            <div class="dashboard-widget lg:col-span-3">
                                <h2 class="widget-title">Nuevos Prospectos (Últimos 6 meses)</h2>
                                <div id="prospects-over-time-chart-container" class="mt-4">
                                     <canvas id="prospectsOverTimeChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        
        <div id="sidebar-overlay" class="fixed inset-0 z-[99] bg-black bg-opacity-50 transition-opacity duration-300 ease-in-out md:hidden hidden"></div>

        <script type="module" src="./firebase.js"></script>
        <script type="module" src="./navigation.js"></script>
        <script type="module" src="./ui.js"></script>
        <script type="module" src="./dashboard-script.js"></script>
        <script>
            lucide.createIcons();
        </script>
    </body>
</html>
